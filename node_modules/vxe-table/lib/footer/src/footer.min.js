"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _ctor=_interopRequireDefault(require("xe-utils/ctor")),_tools=require("../../tools");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperty(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var cellType="footer";function mergeFooterMethod(e,t,o){for(var l=0;l<e.length;l++){var r=e[l],n=r.row,a=r.col,i=r.rowspan,c=r.colspan;if(-1<a&&-1<n&&i&&c){if(n===t&&a===o)return{rowspan:i,colspan:c};if(n<=t&&t<n+i&&a<=o&&o<a+c)return{rowspan:0,colspan:0}}}}var _default={name:"VxeTableFooter",props:{footerData:Array,tableColumn:Array,visibleColumn:Array,fixedColumn:Array,size:String,fixedType:String},mounted:function(){var e=this.$parent,t=this.$el,o=this.$refs,l=this.fixedType,r=e.elemStore,n="".concat(l||"main","-footer-");r["".concat(n,"wrapper")]=t,r["".concat(n,"table")]=o.table,r["".concat(n,"colgroup")]=o.colgroup,r["".concat(n,"list")]=o.tfoot,r["".concat(n,"xSpace")]=o.xSpace},render:function(O){var e=this._e,q=this.$parent,A=this.fixedType,t=this.fixedColumn,D=this.tableColumn,M=this.footerData,X=q.$listeners,o=q.tId,l=q.footerRowClassName,j=q.footerCellClassName,r=q.footerRowStyle,N=q.footerCellStyle,R=q.footerAlign,U=q.mergeFooterList,z=q.footerSpanMethod,B=q.align,H=q.scrollXLoad,K=q.columnKey,V=q.showFooterOverflow,W=q.currentColumn,Y=q.overflowX,n=q.scrollbarWidth,G=q.tooltipOpts;return U.length&&z||(A&&V?D=t:H&&A&&(D=t)),O("div",{class:["vxe-table--footer-wrapper",A?"fixed-".concat(A,"--wrapper"):"body--wrapper"],attrs:{"data-tid":o},on:{scroll:this.scrollEvent}},[A?e():O("div",{class:"vxe-body--x-space",ref:"xSpace"}),O("table",{class:"vxe-table--footer",attrs:{"data-tid":o,cellspacing:0,cellpadding:0,border:0},ref:"table"},[O("colgroup",{ref:"colgroup"},D.map(function(e,t){return O("col",{attrs:{name:e.id},key:t})}).concat(n?[O("col",{attrs:{name:"col_gutter"}})]:[])),O("tfoot",{ref:"tfoot"},M.map(function(P,k){var E=k;return O("tr",{class:["vxe-footer--row",l?_ctor.default.isFunction(l)?l({$table:q,_rowIndex:k,$rowIndex:E,fixed:A,type:cellType}):l:""],style:r?_ctor.default.isFunction(r)?r({$table:q,_rowIndex:k,$rowIndex:E,fixed:A,type:cellType}):r:null},D.map(function(t,e){var o,l=t.showFooterOverflow,r=t.footerAlign,n=t.align,a=t.footerClassName,i=G.enabled,c=t.children&&t.children.length,s=A?t.fixed!==A&&!c:t.fixed&&Y,d=_ctor.default.isUndefined(l)||_ctor.default.isNull(l)?V:l,f=r||n||R||B,u="ellipsis"===d,p="title"===d,v=!0===d||"tooltip"===d,x=p||v||u,m={"data-colid":t.id},y={},g=q.getColumnIndex(t),b=q._getColumnIndex(t),_={$table:q,_rowIndex:k,$rowIndex:E,column:t,columnIndex:g,$columnIndex:e,_columnIndex:b,itemIndex:b,items:P,fixed:A,type:cellType,data:M};if(H&&!x&&(u=x=!0),(p||v||i)&&(y.mouseenter=function(e){p?_tools.DomTools.updateCellTitle(e.currentTarget,t):(v||i)&&q.triggerFooterTooltipEvent(e,_)}),(v||i)&&(y.mouseleave=function(e){(v||i)&&q.handleTargetLeaveEvent(e)}),X["footer-cell-click"]&&(y.click=function(e){q.emitEvent("footer-cell-click",Object.assign({cell:e.currentTarget},_),e)}),X["footer-cell-dblclick"]&&(y.dblclick=function(e){q.emitEvent("footer-cell-dblclick",Object.assign({cell:e.currentTarget},_),e)}),U.length){var h=mergeFooterMethod(U,k,b);if(h){var w=h.rowspan,T=h.colspan;if(!w||!T)return null;1<w&&(m.rowspan=w),1<T&&(m.colspan=T)}}else if(z){var $=z(_)||{},C=$.rowspan,I=void 0===C?1:C,S=$.colspan,F=void 0===S?1:S;if(!I||!F)return null;1<I&&(m.rowspan=I),1<F&&(m.colspan=F)}var L="seq"===t.type||"index"===t.type?"seq":t.type;return O("td",{class:["vxe-footer--column",t.id,(o={},_defineProperty(o,"col--".concat(f),f),_defineProperty(o,"col--".concat(L),L),_defineProperty(o,"col--last",e===D.length-1),_defineProperty(o,"fixed--hidden",s),_defineProperty(o,"col--ellipsis",x),_defineProperty(o,"col--current",W===t),o),_tools.UtilTools.getClass(a,_),_tools.UtilTools.getClass(j,_)],attrs:m,style:N?_ctor.default.isFunction(N)?N(_):N:null,on:y,key:K?t.id:e},[O("div",{class:["vxe-cell",{"c--title":p,"c--tooltip":v,"c--ellipsis":u}]},t.renderFooter(O,_))])}).concat(n?[O("td",{class:"col--gutter"})]:[]))}))])])},methods:{scrollEvent:function(e){var t=this.$parent,o=this.fixedType,l=t.$refs,r=t.scrollXLoad,n=t.triggerScrollXEvent,a=t.lastScrollLeft,i=l.tableHeader,c=l.tableBody,s=l.tableFooter,d=l.validTip,f=i?i.$el:null,u=s?s.$el:null,p=c.$el,v=u.scrollLeft,x=v!==a;t.lastScrollLeft=v,t.lastScrollTime=Date.now(),f&&(f.scrollLeft=v),p&&(p.scrollLeft=v),r&&x&&n(e),x&&d&&d.visible&&d.updatePlacement(),t.emitEvent("scroll",{type:cellType,fixed:o,scrollTop:p.scrollTop,scrollLeft:v,isX:x,isY:!1},e)}}};exports.default=_default;